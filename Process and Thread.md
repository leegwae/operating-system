# Process and Thread

## 프로세스

**프로세스(process)**는 실행 중인 프로그램을 의미하며, CPU의 작업 단위이다. 운영체제로부터 시스템 자원(CPU 시간, 주소 공간, 메모리 등)을 할당받는 주체이다. **주소 공간(process address space)**은 프로세스가 사용할 수 있는 주소의 범위를 정의한 것으로 코드 세그먼트(code segment), 데이터 세그먼트(data segment), 스택 세그먼트(stack segment)로 나뉜다. 코드 세그먼트는 실행될 프로그램의 코드를, 데이터 세그먼트는 전역 변수 등 초기회된 변수를, 스택 세그먼트는 지역 변수, 반환값 등 함수와 관련한 데이터를 저장한다. 스택과 데이터 사이의 빈 공간은 힙(heap)이라고 하며, 동적 메모리를 할당할 때 사용한다. 한편 운영체제는 프로세스를 관리하기 위하여 각 프로세스를 실행하기 위해 필요한 정보를 담은 **PCB(process control block 혹은 process table)**를 유지한다.



### 문맥 교환

**문맥 교환(context switching)** 혹은 **프로세스 교환(process switching)**은 CPU가 이전에 실행되던 프로세스의 정보를 PCB에 저장하고 실행하려는 프로세스의 정보를 PCB에서 읽어 레지스터에 적재하는 것이다.  메모리 캐시를 플러시, 재적재하고 메모리 사상을 교체하는 등의 작업을 수행하므로 오버헤드가 발생한다.



### 멀티 프로세스

**멀티 프로세스(multi process)**는 여러 개의 CPU로 하나 이상의 프로세스를 병럴적으로 처리하는 것을 의미한다. 각각의 프로세스는 독립적으로 자원을 할당받으므로 하나의 프로세스의 상태가 다른 프로세스에게 영향을 끼치지 않는다는 장점이 있다. 그러나 각각 자원을 할당해야한다는 점에서 자원 소모가 크며, 문맥 교환이 잦다면 오버헤드가 발생한다. 또한 프로세스는 서로의 자원에 접근하기 위하여 복잡하고 어려운 **IPC(inter-process communication; 프로세스 간 통신)** 기법을 사용해야 한다.



## 스레드

**스레드(thread)**는 프로세스 내에 있는 여러 개의 실행의 흐름을 일컫는 단위이다. 프로세스는 한 개 이상의 스레드를 가지게 된다. 같은 프로세스 내에 있는 스레드들은 프로세스가 할당받은 자원을 공유하나, 각각의 스레드는 독립적으로 함수를 호출하므로 스택은 독립적으로 할당받는다. 



### 멀티 스레드

**멀티 스레드(multi thread)**는 하나의 프로세스가 여러 개의 스레드로 구성되어, 하나의 스레드가 하나의 작업을 처리하는 것을 말한다. 스레드는 자원을 공유하므로 자원 소모가 적으며 데이터 영역 혹은 힙 영역을 사용하여 데이터를 주고받을 수 있어 스레드 간의 통신이 간단하다. 또한 스레드의 문맥 교환은 캐시를 초기화하지 않아도 되므로 비용이 적다. 그러나 하나의 스레드에 이상이 있으면 프로세스 자체가 죽어버릴 수도 있다(다른 스레드 모두 종료될 수 있다). 또한 자원을 공유하므로 **임계 영역(critical section)**에 대해 **동기화 작업**을 필요로 한다.



## 프로세스와 스레드의 차이

각각의 프로세스는 독립적이어서 서로의 자원에 접근할 수 없다. 서로의 자원에 접근하기 위해 IPC를 사용해야 한다. 그러나 스레드는 한 프로세스 안에 있다면 스택을 제외하고 프로세스가 할당받은 자원을 공유한다.



## 멀티 스레드를 사용하는 이유

프로세스는 자원을 독립적으로 할당받으므로 시스템 자원을 그만큼 소모해야 하며, 문맥 교환 비용이 크다. 서로의 자원에 접근하기 위한 프로세스 간 통신도 어렵다. 그러나 스레드는 프로세스가 할당받은 자원을 공유하므로 자원을 덜 소모하며, 문맥 교환 비용도 더 적다. 데이터 영역이나 힙 영역을 공유하므로 스레드 간 통신이 쉽다.